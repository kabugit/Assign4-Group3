---
title: "Assignment4-Group3"
author: "Group3"
date: "03/06/2020"
output:
  bookdown::html_document2
---

```{r echo = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# Ketan Kabu:

## Correlation of version development and rating

### What is version code?

Version code is a positive integer used as an internal version number. This number is used only to determine whether one version is more recent than another, with higher numbers indicating more recent versions. The value is a positive integer so that other apps can programmatically evaluate it, for example to check an upgrade or downgrade relationship.@mcmurtry_zampano_2020

```{r}
library(tidyverse)
library(dplyr)
library(kableExtra)
library(plotly)
```


```{r}
# Reading the data
data <- read.csv(here::here("data", "AppleStore.csv"))

```


```{r}
vers <- data %>% 
  filter(!rating_count_tot %in% 0:99) %>% 
  mutate(Main_Ver = as.integer(sub("\\..*", "", ver))) # Removed apps that have total ratings posted less than 100, as this indicates a considerable lack of usage

```
### Average number of app developments of top 30 apps

Top 30 apps are chosen on the basis of usage, which in this case is assumed to be total rating counts.



```{r app-tab}
# Filtering top 30 apps by usage (rating count)
top_apps <- vers %>% 
  arrange(desc(rating_count_tot)) %>% 
  slice(1:30)

# Calculating average major development for top 30 apps  
top_apps_dev <- top_apps %>% 
  group_by(track_name) %>%
  summarise(`Average Major Developments` = as.integer(mean(Main_Ver, na.rm = TRUE))) %>% 
  arrange(desc(`Average Major Developments`)) %>% 
  rename("App" = track_name)

# Creating table using kable to display findings
knitr::kable(top_apps_dev, caption = "Top apps and their developments") %>% 
  kable_styling(latex_options = c("striped", "hold_position"))
```
Table \@ref(tab:app-tab)


Facebook is the app that by far has had the most developments out of the top 30 apps, with 95 major developments. This is followed by Google with 27 and Instagram with 10. 
Interestin to note that Temple Run and Subway Surfers, 2 apps that are widely popular and been around since a long time have only had 1 major development.


## Average number of app developments of all genres

Let's take a look at the genres with highest number of major developments


```{r genre-tab}
genre_dev <- vers %>% 
  group_by(prime_genre) %>% 
  summarise(`Average Developments` = as.integer(mean(Main_Ver, na.rm = TRUE))) %>%   arrange(desc(`Average Developments`)) %>% 
  rename("Genre" = prime_genre)

#Creating table using kable to display findings
knitr::kable(genre_dev, caption = "Genres and their developments") %>% 
  kable_styling(latex_options = c("striped", "hold_position"))
```
Table \@ref(tab:genre-tab)

As we can see, Finance and Sports apps seem to have a massive number of developments with 100 and 34 average major developments respectively. Is it that all Finance and Sports apps have such massive number of developments or are there outliers spiking the average?

### Finance apps with most number of developments
```{r finance-tab}
finance_dev <- vers %>%
  filter(prime_genre == "Finance") %>% 
  group_by(track_name) %>% 
  summarise(`Average Developments` = as.integer(mean(Main_Ver, na.rm = TRUE))) %>%   arrange(desc(`Average Developments`)) %>% 
  rename("Apps" = track_name) 
finance_dev <- finance_dev %>% 
  slice(-c(3,4,12,13,20,22,24,25)) # Removing app names that are not readable
finance_dev <- finance_dev %>% slice(1:20) # Displaying top 20 apps
  
#Creating table using kable to display findings
knitr::kable(finance_dev, caption = "Finance app developments") %>% 
  kable_styling(latex_options = c("striped", "hold_position"))  
  
```
Table \@ref(tab:finance-tab)

Stock Market HD and Stock Market Pro clearly show a much higher number of major developments, 2023 each. The 3rd highest developed app, Citi Mobile, has had only 8 major developments. 

### Sports apps with most number of developments
```{r sports-tab}
sports_dev <- vers %>%
  filter(prime_genre == "Sports") %>% 
  group_by(track_name) %>% 
  summarise(`Average Developments` = as.integer(mean(Main_Ver, na.rm = TRUE))) %>%   arrange(desc(`Average Developments`)) %>% 
  rename("Apps" = track_name) 
sports_dev <- sports_dev %>% slice(-c(15,23)) # Removing app names that are not readable

sports_dev <- sports_dev %>% slice(1:20) # Displaying top 20 apps
  
#Creating table using kable to display findings
knitr::kable(sports_dev, caption = "Sports app developments") %>% 
  kable_styling(latex_options = c("striped", "hold_position"))  
  
```
Table \@ref(tab:sports-tab)

Like finance apps in table \@ref(tab:finance-tab), the app NBA spikes the average developments of the sports genre with 2013 major developments, whereas, the second highest app NFL only has 14 major developments.

### Relationship between major developments and rating

```{r}
# Tidying data before plotting
plot_genre_data <- vers %>%
  select(prime_genre, user_rating, Main_Ver) %>% 
  group_by(prime_genre) %>% 
  summarise(`Average Developments` = as.integer(mean(Main_Ver, na.rm = TRUE)),
            `Average Ratings` = as.numeric(mean(user_rating, na.rm = TRUE))) %>%    arrange(desc(`Average Developments`)) %>%
  rename("Genre" = prime_genre)

plot_genre_data$`Average Ratings` <- round(plot_genre_data$`Average Ratings`, 1)
```
Please hover pointer over the scatter plot points to view the Genre
```{r}
# Plotting
dev_plot <- plot_genre_data %>%
  ggplot(aes(x = `Average Developments`, y = `Average Ratings`, color = Genre)) + 
  geom_point(alpha = 0.7)

ggplotly(dev_plot)
```

The plot above indicates that finance apps (on the far right) have had way more major developments than any other genre of apps, but not a relatively high rating.
Most of the app genres lie in the range of 1-12 developments, while also hovering around the 4 star rating, which is quite decent.
But finance and sports, with their huge number of major developments, lie below 4 rating, with sport at 3.6 and finance at 3.8 respectively.

Although, we know from table \@ref(tab:finance-tab) and \@ref(tab:sports-tab) that not all apps in these genres have had that many developments, with only a few spiking the average.

Health And Fitness, Games have the highest average rating among all genres, even though average major developments are only 3 and 4 respectively.

For Finance and Sports, though, if we remove the outliers spiking the average, what would the above plot shape up to be?

```{r}
plot_genre_filt <- vers %>%
  select(prime_genre, track_name, user_rating, Main_Ver) %>% 
  filter(!track_name %in% c("NBA", "Stock Market HD: Real Time Stocks Tracker + Forex", "Stock Market Pro: Stock Trading, Charts & Alerts")) %>% 
  group_by(prime_genre) %>% 
  summarise(`Average Developments` = as.integer(mean(Main_Ver, na.rm = TRUE)),
            `Average Ratings` = as.numeric(mean(user_rating, na.rm = TRUE))) %>%    arrange(desc(`Average Developments`)) %>%
  rename("Genre" = prime_genre)
plot_genre_filt$`Average Ratings` <- round(plot_genre_filt$`Average Ratings`, 1)

dev_plot_filt <- plot_genre_filt %>%
  ggplot(aes(x = `Average Developments`, y = `Average Ratings`, color = Genre)) + 
  geom_point(alpha = 0.7)

ggplotly(dev_plot_filt)
```

By removing only 2 outlier apps (Stock Martket Pro, Stock Markter HD) from Finance and one (NBA) from Sport, the graph becomes much more appropriately scaled. Finance average developments drop from 100 to 4, whereas Sports drops from 34 to 4.

