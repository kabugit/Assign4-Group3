---
title: "Assignment4-Group3"
author: "Group3"
date: "03/06/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Diyao Chen: 
1. Which genre are highest rated?
2. Which genre support most languages?
3. Which genre support most devices?

# Sen Wang: 
1. Genre-rating-price correlation?
2. Genre-rating-size correlation?

# Yezi He
```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(forcats)
library(kableExtra)

dat <- read_csv(here::here("data/AppleStore.csv"))
```


1. Most number of rating counts for which genre? (i.e., number of people who rated)

```{r}
num_rating_count <- dat %>%
  group_by(prime_genre) %>%
  summarise(count = sum(rating_count_tot))
num_rating_count_rank <- num_rating_count %>%
  rename(genre = "prime_genre") %>%
  arrange(-count) %>%
  head(7)
```

```{r numcount, fig.cap="Most number of rating counts for which genre"}            
ggplot(num_rating_count,
       aes(x = count,
           y = fct_reorder(prime_genre, count))) +
  geom_col() + 
  labs(x = "Number of rating counts",
       y = "Genre",
       title = "Most number of rating counts for which genre") 
```

```{r ranknumcount}
kable(num_rating_count_rank,
        caption = "The rank of rating counts for which genre") %>%
    kable_styling(bootstrap_options = 
                  c("striped", "condensed"), 
                  full_width = F,
                  position = "center") %>% 
    row_spec(c(1:3), 
             bold = T, 
             color = "white", 
             background = "steelblue")
```

It can be seen from Figure \@ref(fig:numcount) and Table \@ref(tab:ranknumcount) that the number of people who rated games is far more than the number of people who rated other genres. The top three are games, social networking and photo & video.

2. Rise/drop in rating since last update?

```{r}
rating_difference <- dat %>%
  mutate(rating_difference = user_rating_ver - user_rating) %>%
  group_by(prime_genre) %>%
  summarise(difference = mean(rating_difference))
rating_difference_rank <- rating_difference %>%
  rename(genre = "prime_genre") %>%
  arrange(difference) %>%
  head(7)
```


```{r ratingdifference, fig.cap="Rise/drop in rating since last update"}
ggplot(rating_difference,
       aes(x = difference,
           y = fct_reorder(prime_genre, difference))) +
  geom_col() + 
  labs(x = "Rating changes",
       y = "Genre",
       title = "Rise/drop in rating since last update")
```

```{r rankratingdifference}
kable(rating_difference_rank,
        caption = "The rank of rise/drop in rating since last update") %>%
    kable_styling(bootstrap_options = 
                  c("striped", "condensed"), 
                  full_width = F,
                  position = "center") %>% 
    row_spec(c(1:3), 
             bold = T, 
             color = "white", 
             background = "steelblue")
```

It can be seen from Figure \@ref(fig:ratingdifference) and Table \@ref(tab:rankratingdifference) that shopping apps have the fastest drop in ratings after last update. Finance and food & drink are followed in the ranking.

# Ketan Kabu:
1. Development-Rating correlation?