---
title: "Assignment4-Group3"
author: "Group3"
date: "03/06/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,  message=FALSE, warning = FALSE)
```

```{r library}
library(tidyverse)
library(readr)
library(kableExtra)
library(ggplot2)
library(forcats)
```

```{r Read data source 1, fig.cap=" ", echo = FALSE, message = FALSE, warning=FALSE}
dat <- read_csvdat <- read_csv(here::here("data/AppleStore.csv"))
```


# Diyao Chen

Nowadays, more and more different type of App on the market. Some is for work, some is for entertainment,we know to know the feekback from the consumers.
In this section, we will analysis the realtionship between different type of app with user rating, language and support different devices.

1. Which genre are highest rated?
```{r q1, fig.cap="Research for gener with rating ", echo = FALSE, message = FALSE, warning=FALSE}
genre_rating <- dat%>%
  group_by(prime_genre)%>%
  summarise(average_rating = mean(user_rating))%>%
  arrange(-average_rating)%>%
  unique()

 knitr::kable(head(genre_rating,10),booktabs = TRUE,
  caption = "Table1. Ranking of rating with different genre") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))%>%
  kable_styling(latex_options = "hold_position") 
  

Graph1<- genre_rating%>%
  ggplot(aes(x =reorder(prime_genre,-average_rating), y = average_rating,fill = prime_genre))+
  geom_bar(stat = "identity", show.legend = FALSE)+
  ggtitle("Figure1. The ranking rate with different genre Apps")+
  theme(axis.text.x=element_text(angle = 90, hjust = 1)) +
  labs(x = "Genre" , y = "Average Rating")
Graph1
```
As we can see from the table1 and the figure1, there are 23 different types of App in the research. The highest rating is type of productivity, which is 4 mark.On the other hand, the lowest rating is catalogs, which is 2.1 mark. overall, the different type of App's ratings are fairly close. The gap of highest and lowest is 1.9.and the top and the second within a tenth of a point.


2. Which genre support most language?
```{r q2, fig.cap="Research for gener with language", echo = FALSE, message = FALSE, warning=FALSE}
gener_language <- dat%>%
  group_by(prime_genre)%>%
  summarise(average_language = mean(lang.num))%>%
  arrange(-average_language)%>%
  unique()


 knitr::kable(head(gener_language,10),booktabs = TRUE,
  caption = "Table2. Ranking of language with different genre") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))%>%
  kable_styling(latex_options = "hold_position") 
   
  

Graph2<- gener_language%>%
  ggplot(aes(x =reorder(prime_genre,-average_language), y = average_language, fill = prime_genre))+
  geom_bar(stat = "identity", show.legend = FALSE)+
  ggtitle("Figure2. The ranking language with different genre Apps")+
  theme(axis.text.x=element_text(angle = 90, hjust = 1)) +
  labs(x = "Genre" , y = "Average Language")
Graph2
```

As we can see from table2 and figure2, the genre of productivity is support the most language, which is the type of 11 different languages.And the lowest is the Finance app, only support 2 types of language about that. The gap is huge between the top and the lowest, but every type of Apps Will provide at least two different languages.

3. Which genre support most devices?
```{r q3, fig.cap="Research for gener with devices", echo = FALSE, message = FALSE, warning=FALSE}
gener_devices <- dat%>%
  group_by(prime_genre)%>%
  summarise(average_devices = mean(sup_devices.num))%>%
  arrange(-average_devices)%>%
  unique()


 knitr::kable(head(gener_devices,10),booktabs = TRUE,
  caption = "Table3.Ranking of support devices with different genre") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))%>%
  kable_styling(latex_options = "hold_position") 
  

Graph3<- gener_devices%>%
  ggplot(aes(x =reorder(prime_genre,-average_devices), y = average_devices, fill = prime_genre))+
  geom_bar(stat = "identity", show.legend = FALSE)+
  ggtitle("Figure3.The ranking devices with different genre Apps")+
  theme(axis.text.x=element_text(angle = 90, hjust = 1)) +
  labs(x = "Genre" , y = "Average Devices")
Graph3
```

As we can see from table3 and figure3,the top on support devices is Games.It support 38 different types of devices and the lowest is Music,which support 35 different types of devices.Each type of app is at least 35 different devices.The gap between the top and lowest is very close.

# Sen Wang


```{r tidy-data}
data2 <- dat %>%
  filter(rating_count_tot > 100) %>%
  mutate(size_mb = size_bytes/1024/1024)
```

1. Genre-rating-price correlation?

```{r data_plot1, fig.cap="No strong relation between app categories and user ratings in different price", message=FALSE, warning=FALSE, fig.width=12, fig.height=12}
# A histogram showing the relation between app categories and user ratings in different price.
data2 %>%
  ggplot(aes(x = prime_genre,
             y = user_rating,
             fill = prime_genre)) +
  geom_histogram(stat = 'summary',
                 fun.y = mean,
                 show.legend = FALSE) +
  coord_flip() +
  labs (x = "Categories", 
        y = "Average of user rating",
        title = "No strong relation between app categories and user ratings in different price") +
  facet_wrap(~price) +
  theme_minimal()
```

According to the Figure \@ref(fig:data_plot1), there is no strong relationship between app categories and user ratings in different price. Each type of App has similar user ratings at different prices. However, we can find that the price of shopping and financial apps is lower than that of other apps, which may be because they hope to gain more users through low threshold, and medical apps are the most expensive, which may be because they provide valuable information about users' health.

2. Genre-rating-size correlation?

```{r data_plot2, fig.cap="The relation between app size and user rating in different genres", message=FALSE, warning=FALSE, fig.width=12, fig.height=12}
# The relation between app size and user_rating in different app categories.
data2 %>%
  ggplot(aes(x = user_rating,
             y = size_mb)) +
  geom_line(stat = 'summary',
            fun.y = mean) +
  labs (x = "Average of user rating",
        y = "Size (MB)",
        title="The relation between app size and user rating in different genres") +
  facet_wrap(~prime_genre)
```

According to the Figure \@ref(fig:data_plot2), for most kinds of apps, with the increase of application size, the average user evaluation increases with the increase of praise. Developers can gain higher user ratings by increasing the size of their apps.




# Yezi He

1. Most number of rating counts for which genre? (i.e., number of people who rated)

```{r}
num_rating_count <- dat %>%
  group_by(prime_genre) %>%
  summarise(count = sum(rating_count_tot))
num_rating_count_rank <- num_rating_count %>%
  rename(genre = "prime_genre") %>%
  arrange(-count) %>%
  head(7)
```

```{r numcount, fig.cap="Most number of rating counts for which genre"}            
ggplot(num_rating_count,
       aes(x = count,
           y = fct_reorder(prime_genre, count))) +
  geom_col() + 
  labs(x = "Number of rating counts",
       y = "Genre",
       title = "Most number of rating counts for which genre") 
```

```{r ranknumcount}
kable(num_rating_count_rank,
        caption = "The rank of rating counts for which genre") %>%
    kable_styling(bootstrap_options = 
                  c("striped", "condensed"), 
                  full_width = F,
                  position = "center") %>% 
    row_spec(c(1:3), 
             bold = T, 
             color = "white", 
             background = "steelblue")
```

It can be seen from Figure \@ref(fig:numcount) and Table \@ref(tab:ranknumcount) that the number of people who rated games is far more than the number of people who rated other genres. The top three are games, social networking and photo & video.

2. Rise/drop in rating since last update?

```{r}
rating_difference <- dat %>%
  mutate(rating_difference = user_rating_ver - user_rating) %>%
  group_by(prime_genre) %>%
  summarise(difference = mean(rating_difference))
rating_difference_rank <- rating_difference %>%
  rename(genre = "prime_genre") %>%
  arrange(difference) %>%
  head(7)
```

```{r ratingdifference, fig.cap="Rise/drop in rating since last update"}
ggplot(rating_difference,
       aes(x = difference,
           y = fct_reorder(prime_genre, difference))) +
  geom_col() + 
  labs(x = "Rating changes",
       y = "Genre",
       title = "Rise/drop in rating since last update")
```

```{r rankratingdifference}
kable(rating_difference_rank,
        caption = "The rank of rise/drop in rating since last update") %>%
    kable_styling(bootstrap_options = 
                  c("striped", "condensed"), 
                  full_width = F,
                  position = "center") %>% 
    row_spec(c(1:3), 
             bold = T, 
             color = "white", 
             background = "steelblue")
```

It can be seen from Figure \@ref(fig:ratingdifference) and Table \@ref(tab:rankratingdifference) that shopping apps have the fastest drop in ratings after last update. Finance and food & drink are followed in the ranking.

# Ketan Kabu:
1. Development-Rating correlation?




